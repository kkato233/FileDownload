<html>
<head>
<link href="css/style.css" type="text/css" rel="stylesheet" />
<title>大きなファイルを効率良くダウンロードするプログラム</title>
</head>
<body>
<div id="PAGE">
<div id="KIZI">
<h1>大きなファイルを効率良くダウンロード</h1>

<h2>概要</h2>
<p>マイクロソフトのダウンロードサイトから数百から数ギガの大きなファイルをダウンロードする場合、
ダウンロード途中で接続が切断されると、せっかく今までダウンロードしたファイルが無駄になり、
また最初からダウンロードを始める必要があります。
 <br />
今までダウンロードしたファイルを無駄にせず続きからダウンロードできないか？
<br />
ネットワークが一時的に切断された場合でもネットワークに接続できたら前回の続きからダウンロードできたら便利だと思い、このプログラムを作成しました。
</p>

<h2>URLを指定してファイルをダウンロード</h2>
<p>
ダウンロードしたいファイルのURLを<strong>ダウンロードURL</strong>の欄に入力して
<strong>「読み込みURLの追加」</strong>ボタンをクリックします。<br />
<img src="download-url.png" alt="ダウンロードページ" /><br />
<img src="download-property.png" alt="プロパティー" /><br />
<img src="DownloadForm.png" alt="ダウンロードフォーム画像" /><br />
<br />
するとファイルのダウンロードを開始します。<br />
ダウンロード中に別の新しいダウンロードURLを登録することもできます。<br />
もし、ダウンロードの途中でネットワーク接続が切断された場合にはネットワークに接続できるようになったタイミングで
ダウンロードを継続します。<br />
ダウンロードの途中でアプリケーションを終了した場合には次回にアプリケーションを起動した場合、
前回のダウンロード未完了のファイルがあれば自動的にダウンロードを開始します。
</p>

<h2>マイクロソフトダウンロードセンターからダウンロード</h2>
<p>
マイクロソフトのダウンロードセンターからファイルをダウンロードする場合ダウンロードするファイルの直接のURLがわかりませんので
以下の手順で操作します。
</p>
<p>
マイクロソフトのダウンロードサイトからファイルをダウンロードするボタンをクリックします。<br />
<br />
<img src="DownloadCenter.png" alt="ダウンロードセンター"/><br />
するとダウンロードのダイアログが表示されますが ここでは<strong>「キャンセル」</strong>をクリックします。<br />
<img src="DownloadDialog.png" alt="ダウンロードダイアログ"/><br />
そしてダウンロード完了ページが表示されますので<br />
<img src="DownloadSuccessPage.png" alt="ダウンロード完了ページ" /><br />
このページにある「ダウンロードを開始する」のURLを<strong>「右クリック」して「プロパティー」を表示</strong>して
<strong>アドレス（URL）</strong>を<strong>コピー</strong>します。<br />
<img src="url-property.png" alt="ダウンロードURLのプロパティー"/><br />
このURLをダウンロードアプリケーションの<strong>ダウンロードURL</strong>の欄に入力して
<strong>「読み込みURLの追加」</strong>ボタンをクリックします。<br />
    <br />
ダウンロードのURLは<code>http://www.microsoft.com/downloads/info.aspx?na=90&p=&SrcDisplayLang=ja&SrcCategoryId=&SrcFamilyId=9ae91ebe-3385-447c-8a30-081805b2f90b&u=http%3a%2f%2fdownload.microsoft.com%2fdownload%2fd%2f4%2f8%2fd488b16c-877d-474d-912f-bb88e358055d%2fIE7-WindowsXP-x86-jpn.exe</code>
のような長いURLになっていますが自動的にダウンロードする実ファイルが置かれている
<code>http://download.microsoft.com</code> に変更されたURLがダウンロードURLとして登録されます。
</p>

<h3>ダウンロードURLリストの編集</h3>
<p>ダウンロードディレクトリの中にある <code>filelist.txt</code> を編集することでダウンロード予定のURLを変更する事ができます。<br />
テキストエディタで <code>filelist.txt</code> ファイルを開いて編集してください。
</p>

<h2>今後の機能追加の予定</h2>
<ul>
<li>ダウンロードに登録したURLはプログラムからダウンロードを中止することができません。
いちいちアプリケーションを終了させてテキストエディタで編集するのは面倒なので画面から中止できるようにする。
</li>
</ul>
<h2>未解決の問題</h2>
<ul>
<li>
<strong>ダウンロードURLをコピー＆ペーストがめんどう</strong><br />
マイクロソフトダウンロードサイトは一旦ダウンロードをキャンセルしてその後でダウンロードURLを取得する必要がある。 
これを、自動的にダウンロードのURLを取得できるようにできると便利なのだが・・どうやって実装したらいいのか・・・。
</li>
<li><strong>ダウンロードしたファイルの破損チェックのために SHA1 や MD5 ハッシュを計算するか？</strong><br />
ダウンロードするファイルを一時中断して続きからダウンロードするという処理は、
同じURLを指定するとダウンロードされるファイルが完全に一致する。と言う事が前提となる。<br />
もし、同じURLで異なるバージョンのファイルが公開されたらダウンロードされたファイルはデータ不整合となる。<br />
世間では ダウンロードされたファイルが正しいかをチェックするためにファイルの <code>SHA1</code> や <code>MD5</code> ハッシュコード
を一緒に公開している場合がある。<br />
ダウンロード完了したらダウンロードURLと共にファイルのハッシュを求めたらいいのでは？ 
</li>
<li>
<strong>異なるファイルを1つのファイルにマージしてしまう危険性</strong><br />
偶然別のURLで同じファイル名のファイルをダウンロードしようとする場合ダウンロードに失敗する可能性がある。<br />
特に ダウンロード途中でネットワークが切断されて ダウンロードが再開された場合に 途中から別のURLのデータと
マージされる可能性がある。<br />
ダウンロードの一時ファイル名を <code>[ダウンロードファイル].[ファイルサイズ].tmp</code> にすると
このようなデータ破損の事故が発生する確率が低くなるのではないか？。<br />
ダウンロードファイルの日付を取得できれば、違うファイルをマージしてしまう可能性がより低くなる。
</li>
</ul>

<h2>サポート</h2>
<p>
このプログラムはまだBeta版ですので、十分なサポートはありません。
<a href="http://hiro3-soft.com">作者のホームページ</a> 
からメールで問い合わせしてください。<br />

<a href="src-0.5.zip" >ソースファイル</a> を公開しますので自由にダウンロードして改造してください。


</p>

</div>
</div>
</body>
</html>